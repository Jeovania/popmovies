<!DOCTYPE html>
<html lang="pt-BR">
	<head>
		<meta charset="utf-8" />
		<link rel="shortcut icon" href="%PUBLIC_URL%/favicon.ico" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Pop Movies - A biblioteca de filmes</title>
		<link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
		<meta name="theme-color" content="#37474f" />
		<meta name="msapplication-TileColor" content="#37474f" />
		<meta name="description" content="A biblioteca de filmes" />
		<meta property="og:locale" content="pt_BR" />
		<meta property="og:type" content="website" />
		<meta property="og:title" content="Pop Movies" />
		<meta property="og:description" content="A biblioteca de filmes" />
		<meta property="og:site_name" content="Pop Movies - A biblioteca de filmes" />
		<meta property="og:image" content="%PUBLIC_URL%/social.jpg" />
		<meta property="og:image:type" content="image/jpeg" />
		<meta property="og:image:alt" content="Pop Movies - A biblioteca de filmes" />
		<meta property="og:image:width" content="600" />
		<meta property="og:image:height" content="315" />
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:site" content="@bannetweb" />
		<meta name="twitter:title" content="Pop Movies" />
		<meta name="twitter:description" content="A biblioteca de filmes" />
		<meta name="twitter:image" content="%PUBLIC_URL%/social.jpg" />
		<meta name="twitter:image:alt" content="Pop Movies" />

		<style>
			.add-button {
				background-color: #222;
				color: #fff;
			}
		</style>
	</head>

	<body>
		<noscript> Você deve ativar o javascript para ver essa página </noscript>
		<div id="root"></div>
		<button class="add-button">Adicionar página à tela inicial</button>
	</body>

	<script>
		if ('serviceWorker' in navigator) {
			window.addEventListener('load', function() {
				navigator.serviceWorker
					.register('service-worker.js')
					.then(
						function(registration) {
							console.log('ServiceWorker registration successful with scope: ', registration.scope)
						},
						function(err) {
							console.log('ServiceWorker registration failed: ', err)
						}
					)
					.catch(function(err) {
						console.log(err)
					})
			})
		} else {
			console.log('service worker is not supported')
		}

		let deferredPrompt
		const addBtn = document.querySelector('.add-button')
		addBtn.style.display = 'none'

		window.addEventListener('beforeinstallprompt', e => {
			// Prevent Chrome 67 and earlier from automatically showing the prompt
			e.preventDefault()
			// Stash the event so it can be triggered later.
			deferredPrompt = e
			// Update UI to notify the user they can add to home screen
			addBtn.style.display = 'block'

			addBtn.addEventListener('click', e => {
				// hide our user interface that shows our A2HS button
				addBtn.style.display = 'none'
				// Show the prompt
				deferredPrompt.prompt()
				// Wait for the user to respond to the prompt
				deferredPrompt.userChoice.then(choiceResult => {
					if (choiceResult.outcome === 'accepted') {
						console.log('User accepted the A2HS prompt')
					} else {
						console.log('User dismissed the A2HS prompt')
					}
					deferredPrompt = null
				})
			})
		})
	</script>
</html>
